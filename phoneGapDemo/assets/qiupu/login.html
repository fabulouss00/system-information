<!DOCTYPE HTML>
<html>
    <head>   	
	<meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no">  	
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"> 
	<title>Login Phoenix3</title> 
	<link rel="stylesheet" href="style/bootstrap.css">
	<link rel="stylesheet" href="style/bootstrap-responsive.css">    
	<link rel="stylesheet" href="style/qiupu-responsive.css">	
	
	<!--[if lte IE 8]>
		<link href="style/IE.css" rel="stylesheet" type="text/css" />
	<![endif]-->   
	<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	<script type="text/javascript" src="js/md5.js"></script>
	<script type="text/javascript" src="js/qiupu.js"></script>
	<script type="text/javascript" src="js/qiupu.login.js"></script>
	<!--
	<script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js?appkey=370651388" type="text/javascript" charset="utf-8"></script>	
	<script src="http://qzonestyle.gtimg.cn/qzone/openapi/qc.js#appId=100266417" type="text/javascript" charset="utf-8"></script> 	
	<script type="text/javascript" src="http://www.google.com/jsapi"></script> 
	-->
	<script type="text/javascript" src="js/qiupu.register.js"></script>
	<!--script type="text/javascript" src="//static.getclicky.com/js"></script-->
	<script type="text/javascript">
		var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
		document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F9aacf3c05656367a5c404f7ac61671ee' type='text/javascript'%3E%3C/script%3E"));//for baidu statistic

/////////////////////////////////////////////////////////////Google Analytics/////////////////////////////////////////////////////////////
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-32237702-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
/////////////////////////////////////////////////////////////Google Analytics/////////////////////////////////////////////////////////////


		//try{ clicky.init(66594697); }catch(e){}//clicky

		if(ForDiscuz == false){
	 		if(($.cookie('ticket') !== null) && ($.cookie('ticket') !== ''))
	 		{//navigate to index page if have ticket in cookie
				 window.location = "home.html";
			}			
		}				
		
        /*
        //Google login scope
        var scope = "http://www.google.com/calendar/feeds";
        function onGoogleDataLoad() {
		    checklogingg();
        }
            
		function checklogingg() {       
            if(window.google){
               if(google.accounts.user.checkLogin(scope)) {
            	   var token = google.accounts.user.login(scope);
			       $.cookie('gg_uid', "googleid", {expires: 7});
			       if($.cookie('bind_gg_info') !== null
			           && $.cookie('bind_gg_info').indexOf('->'+$.cookie('gg_uid')) > 0) {
					    var bpcv = $.cookie('bind_gg_info');
					    bpcv = bpcv.substring(0,bpcv.indexOf('->'+$.cookie('gg_uid')));
					    var uid = bpcv.substring(0,bpcv.indexOf(':'));
					    var pswd = bpcv.substring(bpcv.indexOf(':')+1,bpcv.length);
					    bindaccountlogin(uid,pswd);
			       } else  window.location = "bind_account.html";            	
               }
            }
		}		
				
		function logingg() {			
           if(window.google) {
              google.accounts.user.login(scope);	
           }
		}        
        
        if (window.google) {
            // Load the latest Google Data JavaScript Client
            google.load('gdata', '2.x');       
            // Call function once the client has loaded
            google.setOnLoadCallback(onGoogleDataLoad);	        	
        }
	    */
	
		var locale = $.cookie('locale');
		if (locale === null) locale = 1;//default is chinese
		$(document).ready(function(){
			setLocaleString(locale);//set locale with cookie/default value
			if(ForDiscuz == false){
				//init sina login widget
				/*WB2.anyWhere(function(W){
					W.widget.connectButton({
						id: "wb_connect_btn",
						type: '3,2',
						callback : {
							login:function(o){
							    $.cookie('sina_uid', o["id"],{ expires: 7 });
							    if($.cookie('bind_sina_info') !== null
								   && $.cookie('bind_sina_info').indexOf('->'+$.cookie('sina_uid')) > 0) {
								       var bpcv = $.cookie('bind_sina_info');
								       bpcv = bpcv.substring(0,bpcv.indexOf('->'+$.cookie('sina_uid')));
								       var uid = bpcv.substring(0,bpcv.indexOf(':'));
								       var pswd = bpcv.substring(bpcv.indexOf(':')+1,bpcv.length);
								       bindaccountlogin(uid,pswd);
							    } else  window.location = "bind_account.html";
						    }
					    }
				   });
			    });

	            //init tencent qq widget
	            QC.Login({btnId:"qq_connect_btn",scope:"all",fullWindow:true,redirectURI:'http://bpc.borqs.com/login.html'},            
	          	         function(dt,opts)
	          	         {   
	          	         	//alert(JSON.stringify(dt)); 
	          	         	QC.Login.getMe(function(openId, accessToken)
	          	         	{
	          	         	    $.cookie('qq_uid', openId, { expires: 7 });                      	
	                            if($.cookie('bind_qq_info') !== null 
	                               && $.cookie('bind_qq_info').indexOf('->'+$.cookie('qq_uid')) > 0)
	                            {  
	                                 var bpcv = $.cookie('bind_qq_info');
	                                 bpcv = bpcv.substring(0,bpcv.indexOf('->'+$.cookie('qq_uid')));          
	                                 var uid = bpcv.substring(0,bpcv.indexOf(':'));
	                                 var pswd = bpcv.substring(bpcv.indexOf(':')+1,bpcv.length);                                            	
	                                 bindaccountlogin(uid,pswd);                                                	
	                            }                                                                        
	                            else  window.location = "bind_account.html";  
	          	         	});               	                                         
	                     },  
	                     function(opts) {
	                     	
	                     }
	           ); */
	                   	         					
				
			}

			expect = verify();
			$('input.inputText').bind("blur",function(event){
				if($(this).val()){
					$(this).next().text("").hide();
					$(this).css({"background":"#fff"},{"border":"1px solid #ccc"});
				}
			}); 


			if(ForDiscuz == false){
				$('#maildiscuz').hide();
			}
			else
			{
				$('#maildiscuz').show();
				$('#mailborqs').hide();
				$('#tblocal').hide();
				$('#wb_connect_btn').hide();
				$('#qq_connect_btn').hide();
				$('#gg_connect_btn').hide();
			}
				                                  			
		});
			     						
		function call(ret)
		{
			if (ret["error_msg"] !== undefined ) {
				$('#password').css({"background":"#FFAFAF"},{"border":"1px solid #ccc"});
				$('#spanPass').text(resAnswer[locale]).show();
				expect = verify();
			}
			else {
				$.cookie('user_id', ret["user_id"],{ expires: 7 });
				$.cookie('ticket', ret["ticket"],{ expires: 7 });
				$.cookie('display_name', ret["display_name"],{ expires: 7 });
				$.cookie('login_name', ret["login_name"],{ expires: 7 });
				if(ForDiscuz == false)
					window.location = "home.html";
				else
					enterDiscuz();
			}
		}
		

		var answer;
		function verify() {
			answer = Math.floor(Math.random() * 10000);
			$('#question').text(resVerify[locale] + ': '  + answer).show();
			return answer;
		}
		
		function bindaccountlogin(id,pswd)
		{
			invokeApi("account/login", {"login_name": id, "password": pswd}, call);			
		}
		
		
		function guestlogin()
		{
				var winWidth;
				if(document.documentElement && document.documentElement.clientHeight && document.documentElement.clientWidth) {
					winWidth = document.documentElement.clientWidth;
					if(winWidth>600){
						invokeApi("account/login", {"login_name": '10471', "password": 'd1c71258af92bc11f3f8d2b812e34551'}, call);
					}
					else{
						window.location = "index.html";
					}
				}		
		}	
		
        
		function verifyFields() {
			if($('#email').val() == ""){
				$('#email').css({"background":"#FFAFAF"},{"border":"1px solid #ccc"});
				$('#spanEmail').text(resEmail[locale]).show();
				return false;
			}

			if($('#password').val() == ""){
				$('#password').css({"background":"#FFAFAF"},{"border":"1px solid #ccc"});
				$('#spanPass').text(resPass[locale]).show();
				return false;
			}			
	
			if ($('#answer').css('visibility') === 'visible') {	
				if($('#answer').val() != String(expect)) {
					$('#answer').css({"background":"#FFAFAF"},{"border":"1px solid #ccc"});
					$('#spanAnswer').text(resAnswer[locale]).show();
					expect = verify();
					return false;
				}
			}

			return true;
		}

		function login() {
			if (!verifyFields()) return false;

			var password = $('#password').val();
			var md5password =hex_md5(password);
			$.cookie('password', md5password,{ expires: 7 });
			invokeApi("account/login", {"login_name": $('#email').val(), "password": md5password}, call)
		}

		function quickEmailRegCall(ret) {
			if (ret["error_msg"] != undefined ) {
				if(ret["error_msg"].indexOf("The login name is existing") >-1) alert(resEmailHasReg[locale]);
				else alert(ret["error_msg"]);
			}
			else alert(resRegSuc[locale]);
		}

		function quickRegister() {
			if (!check_email($('#email').val())) {
				$('#email').css({"background":"#FFAFAF"},{"border":"1px solid #ccc"});
				$('#spanEmail').text(resInvEmail[locale]).show();
				return false;
			}
			if (!verifyFields()) return false;

			password = $('#password').val();
			md5password = hex_md5(password);
			invokeApi("account/create", {"display_name":$('#email').val(), "password": md5password, "login_email":$('#email').val()}, quickEmailRegCall);
		}

		function onKeyPressed(ev)
		{
			//do login if press enter key
			if (ev.keyCode == 13) login();
		}	

	</script>
  </head> 
  <body>
        <!-- HEADER START -->
	<div class='navbar navbar-inner navbar-fixed-top hideOnPhone'>
		<a class="brand" id='aBrand'></a>
		<a class='navbar-text' id='aBox' href="appstore.html"></a>
		<!--div class="nav-collapse"-->
			<ul class="nav pull-right" style='margin-top:10px'>
				<!--
				<li><div id="wb_connect_btn"></div></li>
				<li><div id="qq_connect_btn"></div></li>
				<li><div id="gg_connect_btn"><a href="javascript:logingg()"><img src="style/images/google_logo.png" onload="javascript:resizeimg(this,102,24)"></a></div></li>	
				-->
				<li id="mailborqs"><a style='padding-left:10px; padding-right:10px; padding-top:5px; padding-bottom:0px' href="mailto:daniel.jing@borqs.com" id='aContact'></a></li>
				<li id="maildiscuz"><a style='padding-left:10px; padding-right:10px; padding-top:5px; padding-bottom:0px' href="mailto:zhenwei.chi@borqs.com" id='aContactdiscuz'></a></li>
			<ul>
		<!--/div-->
	</div>
        <!-- HEADER END -->
  
<div class="container row" style='margin:auto' id='v1.0.0'>
	<table style='margin:auto'>
		<tr>
			<td align=right><div class='span6 hideOnPhone'><img src='style/images/login.jpg' title='♥ be with you.'></div></td>
			<td><div class='span5' style='margin-top:20px; margin-left:30px'>
				<label id='labelEmail' style="font-size: 16px;"></label>
				<input type="text" id="email" name="username" class="inputText" onkeyup="onKeyPressed(event)"/>
				<span id='spanEmail' style='display:none'></span>
				<P></P>

				<table><tr>
					<td><div id='labelPass' style="font-size: 16px;"></td>
					<td><a id='aReset' href="recover_show.html"></a></td>
				</tr></table>

				<input type="password" id="password" name="password" class="inputText" onkeyup="onKeyPressed(event)"/>
				<span id='spanPass' style='display:none'></span>
				<P></P>

				<label class='hideOnPhone' style="font-size: 16px" id="question"></label>
				<input type="text" id="answer" class="inputText hideOnPhone" onkeyup="onKeyPressed(event)"/>
				<span id='spanAnswer' style='display:none'></span>
				<P></P>

				<div>
					<div type="button" id='inputLogin' class="btn btn-primary btn-middle" onclick="login()"></div>
					<div type="button" id='inputGuest' class="btn btn-warning btn-middle" onclick="guestlogin()"></div>
					<div type="button" id='inputRegister' class="btn btn-primary btn-middle" onclick="quickRegister()"></div>
				</div>			
			</div>
			</td>
		</tr>
		
		<tr class='hideOnPhone'><td colspan=2 style='text-align:center'>
			<br><br>
			<footer>Copyright © 2007 - 2012 BORQS International Holding Corp. All Rights Reserved. <br>京ICP备09033675号</footer>
		</td></tr>
	</table>
			
	<table id ="tblocal" style='margin:auto; margin-top:20px; margin-bottom:20px'><tr>
		<td class='btn' onclick='setLocale(0)'>English</td>
		<td class='btn' onclick='setLocale(1)'>中文</td>
		<td class='btn' onclick='setLocale(2)'>português</td>
		<td class='btn' onclick='setLocale(3)'>日本语</td>
	</tr></table>	
</div>

  </body>
</html>
